# NanoDL

一个C++深度学习最小框架，尽可能地实现了深度学习框架的基础功能，包括：

- 自动微分：根据输入的符号表达式构建计算图，计算正向输出和反向传播的梯度。出于性能考虑采用静态计算图，在计算前需要手动调用构建计算图的方法。

- 张量计算：实现`Tensor`类中多维数据的基础运算（加减乘除，特殊一元函数如Log，Exp等），目前仅支持基础CPU运算

- 基础算子：包括Reduce，Conv2d, Maxpool2d等

## 构建

项目采用Cmake构建

```bash
mkdir build
cd build
cmake ..
make
```

使用CTest可执行测试代码

```bash
cd build
ctest --verbose
```

## 架构

- `Value`类：计算图节点的外部接口，通过计算图对象`AutoGradGraph`的几个数学函数方法或者`+-*/`运算符将触发计算图生成新的节点并加入管理

- `Node`类：储存计算图节点信息的数据类型，包括值和梯度信息。节点的各种运算可以通过`forward`和`backward`描述，不同函数的实现可通过继承该类完成，不同数据类型的实现可通过模板特化完成

- `AutoGradGraph`类：实现针对不同数据类型的计算图节点管理和计算图构建

- `Tensor`类：张量数据类型对象，底层采用一维`double`数组管理
